"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCartByToken=exports.getCartById=void 0;const database_1=require("../models/database"),userUtils_1=require("./userUtils");function getCartById(cartID){return __awaiter(this,void 0,void 0,(function*(){try{let table="public.cart",columnsMatchValues={id:cartID},data=yield database_1.knex.table(table).select().where(columnsMatchValues);const cart=data[0];table=`public.${cart.itemsTable}`;const table2="public.item",idColumn=`${table}.id`,idColumn2=`${table2}.id`;return columnsMatchValues={},columnsMatchValues[`${idColumn}`]=idColumn2,data=yield database_1.knex.table(table).select().join(table2,columnsMatchValues),cart.items=data,cart}catch(error){}}))}function getCartByToken(email,token){return __awaiter(this,void 0,void 0,(function*(){const user=yield(0,userUtils_1.getUserByToken)(email,token);return yield getCartById(user.cartID)}))}exports.getCartById=getCartById,exports.getCartByToken=getCartByToken;