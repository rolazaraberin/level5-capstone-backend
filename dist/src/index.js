(()=>{"use strict";var __webpack_modules__={44:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),__webpack_require__(236);const typeorm_1=__webpack_require__(250),User_1=__importDefault(__webpack_require__(55)),Login_1=__importDefault(__webpack_require__(173)),_1672176285655_addData_1=__importDefault(__webpack_require__(723)),dotenv=undefined;__importStar(__webpack_require__(142)).config();const AppDataSource=getDataSource("elephantsql");function getDataSource(dataSouceName){const dataSources=undefined;return{mysql:new typeorm_1.DataSource({type:"mysql",host:"localhost",username:process.env.mysqlUser,password:process.env.mysqlPassword,database:process.env.mysqlDatabase,synchronize:!0,logging:!1,entities:[User_1.default,Login_1.default],migrations:[_1672176285655_addData_1.default],subscribers:[]}),elephantsql:new typeorm_1.DataSource({type:"postgres",url:process.env.elephantsql,synchronize:!0,logging:!1,entities:[User_1.default,Login_1.default],migrations:[_1672176285655_addData_1.default],subscribers:[]})}[dataSouceName]}exports.default=AppDataSource},540:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const dotenv_1=undefined;__importDefault(__webpack_require__(142)).default.config();const knexConfig=getConfig("elephantsql");function getConfig(configName){const configurations=undefined;return{mode:"development",development:{client:"mysql",connection:{user:process.env.devUser,password:process.env.devPassword,database:process.env.devDatabase,multipleStatements:!0},migrations:{directory:"./src/models/migrations"},seeds:{directory:"./src/models/seeds"},useNullAsDefault:!0},mysql:{client:"mysql",connection:{user:process.env.devUser,password:process.env.devPassword,database:process.env.devDatabase,multipleStatements:!0},migrations:{directory:"./src/models/migrations"},seeds:{directory:"./src/models/seeds"},useNullAsDefault:!0},sqlite:{client:"better-sqlite3",connection:{filename:"./src/models/db.sqlite"},migrations:{directory:"./src/models/migrations"},seeds:{directory:"./src/models/seeds"},useNullAsDefault:!0},elephantsql:{client:"pg",connection:{connectionString:process.env.elephantsql,ssl:{rejectUnauthorized:!1}},migrations:{directory:"./src/models/migrations"},seeds:{directory:"./src/models/seeds"},useNullAsDefault:!0,pool:{min:0,max:1}},remote:{client:"pg",connection:{connectionString:process.env.remoteURL,ssl:{rejectUnauthorized:!1}},migrations:{directory:"./src/data/migrations"},seeds:{directory:"./src/data/seeds"},useNullAsDefault:!0,pool:{min:0,max:1}}}[configName]}exports.default=knexConfig},863:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const nodeUtils_1=__webpack_require__(771),database_1=__webpack_require__(911),authenticate_1=__importDefault(__webpack_require__(717)),httpCodes_1=__importDefault(__webpack_require__(820)),sendEmail_1=__importDefault(__webpack_require__(520)),User_1=__importDefault(__webpack_require__(55)),Login_1=__importDefault(__webpack_require__(173)),dotenv_1=__importDefault(__webpack_require__(142)),cartUtils_1=__webpack_require__(674),userUtils_1=__webpack_require__(406),account={fetchInfo,delete:_delete};exports.default=account,dotenv_1.default.config();const disableEmails=process.env.disableEmails;function fetchInfo(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const{email,token}=request.body,userID=yield authenticate_1.default.token(email,token),account=yield getAccountInfo(userID);if(!account)return response.status(401).send("ERROR: Cannot retrieve account");response.status(200).send(account)}catch(asyncError){handleAsyncError(asyncError,response)}}))}function getAccountInfo(userID){return __awaiter(this,void 0,void 0,(function*(){try{const account=yield(0,userUtils_1.getUserById)(userID);return account.cart=yield(0,cartUtils_1.getCartById)(account.cartID),account}catch(error){}}))}function _delete(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const{email,password}=request.body,{userID}=yield authenticate_1.default.password(email,password);yield deleteLogin(email),yield deleteUser(userID),response.status(200).send("SUCCESS: Account deleted"),"true"!==disableEmails&&sendEmail_1.default.deleteConfirmation(email)}catch(asyncError){const error=yield asyncError;let message=error.message,code=error.code||httpCodes_1.default.error.general;code===httpCodes_1.default.error.unauthenticated&&(message="ERROR: Incorrect password"),response.status(code).send(message)}}))}function deleteUser(userID){return __awaiter(this,void 0,void 0,(function*(){const data=undefined;return yield database_1.typeorm.getRepository(User_1.default).delete(userID)}))}function deleteLogin(email){return __awaiter(this,void 0,void 0,(function*(){const emailHash=undefined,columnsMatchValues={emailHash:(0,nodeUtils_1.hash)(email)},data=undefined;return yield database_1.typeorm.getRepository(Login_1.default).delete(columnsMatchValues)}))}function handleAsyncError(asyncError,response){return __awaiter(this,void 0,void 0,(function*(){const error=yield asyncError,message=error.message,code=error.code||httpCodes_1.default.error.general;response.status(code).send(message)}))}},717:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const httpCodes_1=__importDefault(__webpack_require__(820)),database_1=__webpack_require__(911),nodeUtils_1=__webpack_require__(771),utilityFunctions_1=__webpack_require__(269),Login_1=__importDefault(__webpack_require__(173)),authenticate={password,token,email,itemsTable};function password(email,password){return __awaiter(this,void 0,void 0,(function*(){if(!email||!password){const error=new Error("ERROR: email and password must be provided");throw error.code=httpCodes_1.default.error.unauthenticated,error}const emailHash=undefined,passwordHash=undefined,columnsMatchValues={emailHash:(0,nodeUtils_1.hash)(email),passwordHash:(0,nodeUtils_1.hash)(password)},data=yield database_1.typeorm.manager.getRepository(Login_1.default).findOne({where:columnsMatchValues,relations:{user:!0}}),userID=data.user.id,token=data.token;if(null===userID){const error=new Error("ERROR: Incorrect email or password");throw error.code=httpCodes_1.default.error.unauthenticated,error}return{userID,token}}))}function token(email,token){var _a;return __awaiter(this,void 0,void 0,(function*(){if((0,utilityFunctions_1.isEmpty)(email)||(0,utilityFunctions_1.isEmpty)(token)){const error=new Error("ERROR: email and password must be provided");throw error.code=httpCodes_1.default.error.unauthenticated,error}const emailHash=(0,nodeUtils_1.hash)(email);if(!emailHash){const error=new Error("ERROR: Invalid email or token");throw error.code=httpCodes_1.default.error.unauthenticated,error}const columnsMatchValues={emailHash,token},data=yield database_1.typeorm.manager.getRepository(Login_1.default).findOne({where:columnsMatchValues,relations:{user:!0}}),userID=null===(_a=null==data?void 0:data.user)||void 0===_a?void 0:_a.id;if(!userID){const error=new Error("ERROR: Invalid email or token");throw error.code=httpCodes_1.default.error.unauthenticated,error}return userID}))}function email(email){return __awaiter(this,void 0,void 0,(function*(){const hashedEmail=(0,nodeUtils_1.hash)(email),authenticateEmailHash=emailHash;yield authenticateEmailHash(hashedEmail)}))}function emailHash(emailHash){return __awaiter(this,void 0,void 0,(function*(){const columnsMatchValues={emailHash},data=yield database_1.typeorm.manager.getRepository(Login_1.default).findOne({where:columnsMatchValues});if((0,utilityFunctions_1.isEmpty)(data)){const error=new Error("ERROR: Account does not exist");throw error.code=httpCodes_1.default.error.unauthenticated,error}return"Email validated"}))}function itemsTable(tableId){return __awaiter(this,void 0,void 0,(function*(){const hashedEmail=tableId,authenticateEmailHash=emailHash;yield authenticateEmailHash(hashedEmail)}))}exports.default=authenticate},674:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCartByToken=exports.getCartById=void 0;const database_1=__webpack_require__(911),userUtils_1=__webpack_require__(406);function getCartById(cartID){return __awaiter(this,void 0,void 0,(function*(){try{let table="public.cart",columnsMatchValues={id:cartID},data=yield database_1.knex.table(table).select().where(columnsMatchValues);const cart=data[0];table=`public.${cart.itemsTable}`;const table2="public.item",idColumn=`${table}.id`,idColumn2=`${table2}.id`;return columnsMatchValues={},columnsMatchValues[`${idColumn}`]=idColumn2,data=yield database_1.knex.table(table).select().join(table2,columnsMatchValues),cart.items=data,cart}catch(error){}}))}function getCartByToken(email,token){return __awaiter(this,void 0,void 0,(function*(){const user=yield(0,userUtils_1.getUserByToken)(email,token);return yield getCartById(user.cartID)}))}exports.getCartById=getCartById,exports.getCartByToken=getCartByToken},287:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0});const utilityFunctions_1=__webpack_require__(269),nodeUtils_1=__webpack_require__(771),database_1=__webpack_require__(911),dbToken={invalidate,getNew,save};function invalidate(email){return __awaiter(this,void 0,void 0,(function*(){const emailHash=undefined,table="login",columnsToValues={token:""},columnsMatchValues={emailHash:(0,nodeUtils_1.hash)(email)},data=yield database_1.knex.table(table).update(columnsToValues).where(columnsMatchValues),{affectedRows}=data;if(affectedRows||data)return affectedRows||data;throw new Error("ERROR: Invalid account")}))}function getNew(email){const token=undefined;return(0,nodeUtils_1.hash)(email+(0,utilityFunctions_1.generateKey)())}function save(email,token){return __awaiter(this,void 0,void 0,(function*(){const emailHash=(0,nodeUtils_1.hash)(email),table="login",columns=["token"],values=(0,utilityFunctions_1.quoteValues)([token]),target="emailHash",match=(0,utilityFunctions_1.quoteValues)([emailHash]),columnsToValues={token},columnsMatchValues={emailHash},sql=`UPDATE login SET ${columns} = ${values} WHERE emailHash = ${match}`,result=undefined;return yield database_1.knex.table(table).update(columnsToValues).where(columnsMatchValues)}))}exports.default=dbToken},298:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const authenticate_1=__importDefault(__webpack_require__(717)),dbToken_1=__importDefault(__webpack_require__(287)),httpCodes_1=__importDefault(__webpack_require__(820)),router_1=__webpack_require__(462),login={withToken,withPassword};function withToken(request,response,next){return __awaiter(this,void 0,void 0,(function*(){const{email,token}=request.body;if(!token)return next();try{const userID=undefined;if(!(yield authenticate_1.default.token(email,token)))return response.status(401).send("ERROR: Incorrect email or password");const authInfo={email,token,isTemporary:!1};response.status(200).send(authInfo)}catch(asyncError){const{code,message}=yield(0,router_1.handleAsyncError)(asyncError);response.status(code).send(message)}}))}function withPassword(request,response){return __awaiter(this,void 0,void 0,(function*(){const{email,password}=request.body;try{const{userID,token}=yield authenticate_1.default.password(email,password);if(!userID)return response.status(401).send("ERROR: Incorrect email or password");const authInfo={email,token,isTemporary:!1};token||(authInfo.token=dbToken_1.default.getNew(email),yield dbToken_1.default.save(email,authInfo.token)),response.status(200).send(authInfo)}catch(asyncError){const error=yield asyncError,message=error.message;let code=error.code||httpCodes_1.default.error.general;(code>=600||"string"==typeof code)&&(code=httpCodes_1.default.error.serverError),response.status(code).send(message)}}))}exports.default=login},617:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const authenticate_1=__importDefault(__webpack_require__(717)),dbToken_1=__importDefault(__webpack_require__(287)),router_1=__webpack_require__(462),logout={withToken};function withToken(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const{email,token}=request.body;yield authenticate_1.default.token(email,token),yield dbToken_1.default.invalidate(email),response.status(200).send("SUCCESS: logged out")}catch(asyncError){const{error,code,message}=yield(0,router_1.handleAsyncError)(asyncError);response.status(code).send(message)}}))}exports.default=logout},520:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const mail_1=__importDefault(__webpack_require__(139)),dotenv_1=undefined;__importDefault(__webpack_require__(142)).default.config();const sendEmail={signupConfirmation,deleteConfirmation};function signupConfirmation(email){const message=undefined;send({from:"rolazaraberin.test@gmail.com",to:email,subject:"Signup Confirmation",text:`${email} has been signed up for Online Store`,html:`<p>${email} has been signed up for Online Store</p>`})}function deleteConfirmation(email){const message=undefined;send({from:"rolazaraberin.test@gmail.com",to:email,subject:"Delete Confirmation",text:`${email} has been deleted from Online Store`,html:`<p>${email} has been deleted from Online Store</p>`})}function send(message){return __awaiter(this,void 0,void 0,(function*(){try{const response=undefined;return(yield mail_1.default.send(message))[0].statusCode}catch(asyncError){const error=yield asyncError;console.log(error)}}))}exports.default=sendEmail,mail_1.default.setApiKey(process.env.sendGridApiKey)},268:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const database_1=__webpack_require__(911),utilityFunctions_1=__webpack_require__(269),nodeUtils_1=__webpack_require__(771),sendEmail_1=__importDefault(__webpack_require__(520)),dbToken_1=__importDefault(__webpack_require__(287)),Login_1=__importDefault(__webpack_require__(173)),User_1=__importDefault(__webpack_require__(55)),dotenv_1=__importDefault(__webpack_require__(142)),signup={withPassword};exports.default=signup,dotenv_1.default.config();const disableEmails=process.env.disableEmails;function withPassword(request,response,_next){return __awaiter(this,void 0,void 0,(function*(){try{const{email,password}=request.body;yield validate(email),yield database_1.typeorm.transaction((function(manager){return __awaiter(this,void 0,void 0,(function*(){const user=createAccount(email),data=yield manager.insert(User_1.default,user);user.id=data.raw[0].id;const login=yield createLogin(email,password,user),token=dbToken_1.default.getNew(email);login.token=token,yield manager.insert(Login_1.default,login);const authInfo={email,token};response.status(200).send(authInfo)}))})),"true"!==disableEmails&&sendEmail_1.default.signupConfirmation(email)}catch(_error){const error=yield _error,message=error.message,code=error.code||400;response.status(code).send(message)}}))}function validate(email){return __awaiter(this,void 0,void 0,(function*(){const emailHash=undefined,columnsMatchValues={emailHash:(0,nodeUtils_1.hash)(email)},data=yield database_1.typeorm.manager.getRepository(Login_1.default).findOne({where:columnsMatchValues});if((0,utilityFunctions_1.isEmpty)(data))return"Email validated";{const error=new Error("ERROR: Account already exists");throw error.code=409,error}}))}function createLogin(email,password,user){return __awaiter(this,void 0,void 0,(function*(){const emailHash=(0,nodeUtils_1.hash)(email),passwordHash=(0,nodeUtils_1.hash)(password),login=new Login_1.default;return login.emailHash=emailHash,login.passwordHash=passwordHash,login.user=user,login}))}function createAccount(email){const user=new User_1.default;return user.email=email,user}},406:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getUserByToken=exports.getUserById=void 0;const Login_1=__importDefault(__webpack_require__(173)),nodeUtils_1=__webpack_require__(771),database_1=__webpack_require__(911);function getUserById(userID){return __awaiter(this,void 0,void 0,(function*(){try{let table,idColumn;const itemsColumn="itemsTable";let sql=`SELECT * FROM ${"public.user"} WHERE ${"id"} = ${userID}`;const columnsMatchValues={id:userID};let data=yield(0,database_1.sql)(sql);const user=undefined;return data[0]}catch(error){}}))}function getUserByToken(email,token){return __awaiter(this,void 0,void 0,(function*(){if(!email)throw new Error("ERROR: email must be provided");if(!token)throw new Error("ERROR: token must be provided");const emailHash=undefined,columnsMatchValues={emailHash:(0,nodeUtils_1.hash)(email),token},data=undefined,user=undefined;return(yield database_1.typeorm.manager.getRepository(Login_1.default).findOne({where:columnsMatchValues,relations:{user:!0}})).user}))}exports.getUserById=getUserById,exports.getUserByToken=getUserByToken},632:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),__webpack_require__(236);const express_1=__importDefault(__webpack_require__(860)),cors_1=__importDefault(__webpack_require__(582)),router_1=__importDefault(__webpack_require__(462)),app=(0,express_1.default)(),hostname=process.env.HOST||"localhost",port=process.env.PORT||8e3,baseUrl="/";function handleListen(){console.log(`Listening on ${hostname}:${port}`)}console.log("Starting server..."),app.use((0,cors_1.default)()),app.use(express_1.default.static("public")),app.use(express_1.default.json()),app.use("/",router_1.default),app.listen(port,handleListen)},109:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const router_1=__webpack_require__(462),authenticate_1=__importDefault(__webpack_require__(717)),validate={token};function token(request,response,next){return __awaiter(this,void 0,void 0,(function*(){try{const{email,token}=request.body.user;return yield authenticate_1.default.token(email,token),next()}catch(asyncError){const{code,message}=yield(0,router_1.handleAsyncError)(asyncError);response.status(code).send(message)}}))}exports.default=validate},911:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},_a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.sql=exports.typeorm=exports.knex=void 0;const db_1=__webpack_require__(81),knexfile_1=__importDefault(__webpack_require__(540)),data_source_1=__importDefault(__webpack_require__(44));_a=(0,db_1.createDB)({knexfileConfig:knexfile_1.default,AppDataSource:data_source_1.default}),exports.knex=_a.knex,exports.typeorm=_a.typeorm,exports.sql=_a.sql},723:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const User_1=__importDefault(__webpack_require__(55)),Login_1=__importDefault(__webpack_require__(173)),utilityFunctions_1=__webpack_require__(269);class addData1672176285655{up(queryRunner){return __awaiter(this,void 0,void 0,(function*(){const users=queryRunner.manager.getRepository(User_1.default),logins=queryRunner.manager.getRepository(Login_1.default);let user,login;yield createTables(users,logins),user=new User_1.default,user.email="rolazaraberin@gmail.com",user.name="Rolazar Aberin",user.cartID=1;const rolazar=yield users.save(user);user=new User_1.default,user.email="correct@email.com",user.name="correct";const correct=yield users.save(user);login=new Login_1.default,login.emailHash="1e9b4ffec7e769ede61e5ce942193ab13db7e9e8d170bb89b6411cfc7dec5e18",login.passwordHash="5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8",login.user=rolazar,yield logins.save(login),login=new Login_1.default,login.emailHash="425bee187ab12fdfe19ea39148510c2a7bf5fce9957f296b90a3dc478e280b78",login.passwordHash="e231b8ff6659dcbbec5aaa6a252d132de5a8dfb8e40167c45e4eb0ffb71a7065",login.user=correct,yield logins.save(login)}))}down(queryRunner){return __awaiter(this,void 0,void 0,(function*(){yield queryRunner.dropTable("public.login"),yield queryRunner.dropTable("public.user")}))}}function createTables(...repositories){return __awaiter(this,void 0,void 0,(function*(){repositories.forEach((repository=>__awaiter(this,void 0,void 0,(function*(){return yield repository.find()})))),yield(0,utilityFunctions_1.timeout)(5e3)}))}exports.default=addData1672176285655},173:function(__unused_webpack_module,exports,__webpack_require__){var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const typeorm_1=__webpack_require__(250),User_1=__importDefault(__webpack_require__(55));let Login=class Login extends typeorm_1.BaseEntity{};__decorate([(0,typeorm_1.PrimaryColumn)(),__metadata("design:type",String)],Login.prototype,"emailHash",void 0),__decorate([(0,typeorm_1.Column)(),__metadata("design:type",String)],Login.prototype,"passwordHash",void 0),__decorate([(0,typeorm_1.Column)({nullable:!0}),__metadata("design:type",String)],Login.prototype,"token",void 0),__decorate([(0,typeorm_1.OneToOne)((()=>User_1.default)),(0,typeorm_1.JoinColumn)(),__metadata("design:type",User_1.default)],Login.prototype,"user",void 0),Login=__decorate([(0,typeorm_1.Entity)()],Login),exports.default=Login},55:function(__unused_webpack_module,exports,__webpack_require__){var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)};Object.defineProperty(exports,"__esModule",{value:!0});const typeorm_1=__webpack_require__(250);let User=class User extends typeorm_1.BaseEntity{};__decorate([(0,typeorm_1.PrimaryGeneratedColumn)(),__metadata("design:type",Number)],User.prototype,"id",void 0),__decorate([(0,typeorm_1.Column)({nullable:!0}),__metadata("design:type",String)],User.prototype,"name",void 0),__decorate([(0,typeorm_1.Column)(),__metadata("design:type",String)],User.prototype,"email",void 0),__decorate([(0,typeorm_1.Column)({nullable:!0}),__metadata("design:type",Number)],User.prototype,"cartID",void 0),User=__decorate([(0,typeorm_1.Entity)()],User),exports.default=User},917:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]]);return t},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const knexfile_1=__importDefault(__webpack_require__(540)),knex_1=__importDefault(__webpack_require__(514)),utilityFunctionsServer_1=__webpack_require__(243),utilityFunctions_1=__webpack_require__(269),authenticate_1=__importDefault(__webpack_require__(717)),cartUtils_1=__webpack_require__(674),inventoryData=createData("inventory");exports.default={manualData,cartData,inventoryData};const knex=(0,knex_1.default)(knexfile_1.default);function createData(route){let mainTable;return"cart"===route&&(mainTable="cart"),"inventory"===route&&(mainTable="inventory"),function(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const validValues=(0,utilityFunctionsServer_1.getValidValues)(request.body),tableData=validValues[mainTable],itemData=validValues.item;let itemsTable=tableData.itemsTable;if(!itemsTable||""===itemsTable){const email=request.body.user.email,emailHash=undefined;itemsTable=(0,utilityFunctions_1.hash)(email)}yield authenticate_1.default.itemsTable(itemsTable);try{yield knex.table(mainTable).insert(tableData)}catch(dataAlreadyExists){yield knex.table(mainTable).update(tableData)}try{yield knex.table(itemsTable).insert(itemData)}catch(dataAlreadyExists){yield knex.table(itemsTable).update(itemData)}let result={};result[mainTable]=yield knex.table(mainTable).select(),result[itemsTable]=yield knex.table(itemsTable).select(),response.status(200).send(result)}catch(error){response.status(400).send(error.message)}}))}}function cartData(request,response,next){return __awaiter(this,void 0,void 0,(function*(){try{const validValues=(0,utilityFunctionsServer_1.getValidValues)(request.body),cart=validValues.cart;if(!cart)return next();const table="cart";try{yield knex.table(table).insert(cart)}catch(dataAlreadyExists){yield knex.table(table).update(cart)}const item=validValues.item,itemsTable=(yield(0,cartUtils_1.getCartById)(cart.id)).itemsTable;try{yield knex.table(itemsTable).insert(item)}catch(dataAlreadyExists){yield knex.table(itemsTable).update(item)}const result=yield(0,cartUtils_1.getCartById)(cart.id);response.status(200).send(result)}catch(error){response.status(400).send(error.message)}}))}function getItemsTable(cartID){return __awaiter(this,void 0,void 0,(function*(){try{const table="cart",columnsMatchValues={id:cartID},data=yield knex.table(table).select().where(columnsMatchValues),itemsTable=undefined;return data[0].itemsTable}catch(error){}}))}function manualData(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const _a=request.body,{table}=_a,data=__rest(_a,["table"]);yield knex.insert(data).table(table);const result=yield knex.table(table).select();response.status(200).send(result)}catch(error){response.status(400).send(error.message)}}))}function getKnex(config,knex){switch(config.mode){case"development":return knex(config.development);case"production":return knex(config.remote)}}},345:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]]);return t},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const knexfile_1=__importDefault(__webpack_require__(540)),knex_1=__importDefault(__webpack_require__(514)),utilityFunctionsServer_1=__webpack_require__(243),cartUtils_1=__webpack_require__(674),knex=(0,knex_1.default)(knexfile_1.default),inventoryData=deleteData("inventory");function manualData(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const _a=request.body,{table}=_a,data=__rest(_a,["table"]),column=Object.getOwnPropertyNames(data)[0],value=data[column];yield knex.table(table).where(column,"=",value).delete();const result=yield knex.table(table).select();response.status(200).send(result)}catch(error){response.status(400).send(error.message)}}))}function deleteData(route){let mainTable;return"cart"===route&&(mainTable="cart"),"inventory"===route&&(mainTable="inventory"),function(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const data=(0,utilityFunctionsServer_1.getValidValues)(request.body);yield knex.table(mainTable).update(data[mainTable]);const itemsTable=data[mainTable].itemsTable,itemID=data.item.itemID;yield knex.table(itemsTable).where("itemID","=",itemID).delete();const result={};result[mainTable]=yield knex.table(mainTable).select(),result[itemsTable]=yield knex.table(itemsTable).select(),response.status(200).send(result)}catch(error){response.status(400).send(error.message)}}))}}function cartData(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const validValues=(0,utilityFunctionsServer_1.getValidValues)(request.body),cart=validValues.cart,table="public.cart";yield knex.table(table).update(cart);const cartID=validValues.cart.id,itemsTable=(yield(0,cartUtils_1.getCartById)(cartID)).itemsTable,itemID=undefined,columnsMatchValues={id:validValues.item.id};yield knex.table(itemsTable).where(columnsMatchValues).delete();const result=yield(0,cartUtils_1.getCartById)(cartID);response.status(200).send(result)}catch(error){response.status(400).send(error.message)}}))}function getKnex(config,knex){switch(config.mode){case"development":return knex(config.development);case"production":return knex(config.remote)}}exports.default={manualData,cartData,inventoryData}},809:(__unused_webpack_module,exports)=>{function urlHome(_request,response){response.sendFile("index.html",{root:"public"})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=urlHome},228:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const knexfile_1=__importDefault(__webpack_require__(540)),knex_1=__importDefault(__webpack_require__(514)),lodash_1=__webpack_require__(517),cartUtils_1=__webpack_require__(674),inventoryData=readData("inventory");exports.default={manualData,cartData,inventoryData,allData};const knex=(0,knex_1.default)(knexfile_1.default),replacer=void 0,spacer=" ";function readData(route){let mainTable;return"cart"===route&&(mainTable="cart"),"inventory"===route&&(mainTable="inventory"),function(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const data=yield knex.table(mainTable).select();let result=Object.assign({},data[0]);const itemsTable=result.itemsTable,items=yield knex.select().from(itemsTable).leftJoin("item",`${itemsTable}.itemID`,"item.id");result=Object.assign(Object.assign({},result),{items}),response.status(200).send(result)}catch(error){response.status(400).send(error)}}))}}function cartData(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const{email,token}=request.body.user,cart=yield(0,cartUtils_1.getCartByToken)(email,token);response.status(200).send(cart)}catch(error){response.status(400).send(error)}}))}function manualData(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const{table}=request.body,data=yield knex.table(table).select();response.status(200).send(data)}catch(error){response.status(400).send(error.message)}}))}function allData(request,response){return __awaiter(this,void 0,void 0,(function*(){if((0,lodash_1.isEmpty)(request.body))try{const item=yield knex.select().from("item"),inventory=yield knex.select().from("inventory"),inventoryItems=yield knex.select().from("inventoryItems"),cart=yield knex.select().from("cart"),cartItems=yield knex.select().from("cartItems"),data=JSON.stringify({item,inventory,inventoryItems,cart,cartItems},undefined," ");response.type("text"),response.status(200).send(data)}catch(error){response.status(400).send(error)}else manualData(request,response)}))}function getKnex(config,knex){switch(config.mode){case"development":return knex(config.development);case"production":return knex(config.remote)}}},462:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleAsyncError=void 0;const express_1=__importDefault(__webpack_require__(860)),home_1=__importDefault(__webpack_require__(809)),create_1=__importDefault(__webpack_require__(917)),read_1=__importDefault(__webpack_require__(228)),update_1=__importDefault(__webpack_require__(331)),delete_1=__importDefault(__webpack_require__(345)),logout_1=__importDefault(__webpack_require__(617)),signup_1=__importDefault(__webpack_require__(268)),login_1=__importDefault(__webpack_require__(298)),account_1=__importDefault(__webpack_require__(863)),httpCodes_1=__importDefault(__webpack_require__(820)),validate_1=__importDefault(__webpack_require__(109)),URL_baseUrl="/",URL_api="/api",URL_cart="/api/cart",URL_inventory="/api/inventory",URL_login="/api/login",URL_logout="/api/logout",URL_signup="/api/signup",URL_account="/api/account",router=express_1.default.Router();function handleAsyncError(asyncError){return __awaiter(this,void 0,void 0,(function*(){const error=yield asyncError,message=error.message;let code=error.code;return(!code||code>=600)&&(code=httpCodes_1.default.error.serverError),{error,code,message}}))}router.get(URL_baseUrl,home_1.default),router.post(URL_api,create_1.default.manualData),router.get(URL_api,read_1.default.allData),router.put(URL_api,update_1.default.idKey),router.delete(URL_api,delete_1.default.manualData),router.post(URL_cart,validate_1.default.token,create_1.default.cartData,read_1.default.cartData),router.put(URL_cart,validate_1.default.token,update_1.default.cartData),router.delete(URL_cart,validate_1.default.token,delete_1.default.cartData),router.post(URL_inventory,create_1.default.inventoryData),router.get(URL_inventory,read_1.default.inventoryData),router.put(URL_inventory,update_1.default.inventoryData),router.put(URL_inventory,delete_1.default.inventoryData),router.post(URL_login,login_1.default.withToken,login_1.default.withPassword),router.post(URL_logout,logout_1.default.withToken),router.post(URL_signup,signup_1.default.withPassword),router.post(URL_account,account_1.default.fetchInfo),router.delete(URL_account,account_1.default.delete),exports.handleAsyncError=handleAsyncError,exports.default=router},331:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]]);return t},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const knexfile_1=__importDefault(__webpack_require__(540)),knex_1=__importDefault(__webpack_require__(514)),utilityFunctionsServer_1=__webpack_require__(243),cartUtils_1=__webpack_require__(674),knex=(0,knex_1.default)(knexfile_1.default),inventoryData=updateData("inventory");function idKey(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const _a=request.body,{table,id}=_a,data=__rest(_a,["table","id"]);yield knex.table(table).update(data).where("id","=",id);const result=yield knex.table(table).select();response.status(200).send(result)}catch(error){response.status(400).send(error.message)}}))}function updateData(route){let mainTable;return"cart"===route&&(mainTable="cart"),"inventory"===route&&(mainTable="inventory"),function(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const data=(0,utilityFunctionsServer_1.getValidValues)(request.body);yield knex.table(mainTable).update(data[mainTable]);const itemsTable=data[mainTable].itemsTable,itemID=data.item.itemID;yield knex.table(itemsTable).update(data.item).where("itemID","=",itemID);let result={};result[mainTable]=yield knex.table(mainTable).select(),result[itemsTable]=yield knex.table(itemsTable).select(),response.status(200).send(result)}catch(error){response.status(400).send(error.message)}}))}}function cartData(request,response){return __awaiter(this,void 0,void 0,(function*(){try{const validValues=(0,utilityFunctionsServer_1.getValidValues)(request.body),table="cart",cart=validValues.cart;yield knex.table(table).update(cart);const itemsTable=(yield(0,cartUtils_1.getCartById)(cart.id)).itemsTable,item=validValues.item,itemID=undefined,columnsMatchValues={id:item.id};yield knex.table(itemsTable).update(item).where(columnsMatchValues);const result=(0,cartUtils_1.getCartById)(cart.id);response.status(200).send(result)}catch(error){response.status(400).send(error.message)}}))}function getKnex(config,knex){switch(config.mode){case"development":return knex(config.development);case"production":return knex(config.remote)}}exports.default={idKey,cartData,inventoryData,updateData}},243:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.toUsedProperties=exports.getValidValues=void 0;const utilityFunctions_1=__webpack_require__(269),validValues=[{table:"cart",properties:["id","itemsTable","totalQuantity","totalPrice"]},{table:"item",properties:["id","itemID","quantity","subtotal"]},{table:"inventory",properties:["id","itemsTable","totalQuantity","totalPrice"]},{table:"user",properties:["email","token"]}];function getValidValues(object,validTablesAndProperties=validValues){validTablesAndProperties instanceof Array||(validTablesAndProperties=[validTablesAndProperties]);let validValues={};for(let validObject of validTablesAndProperties){const table=validObject.table;let validProperties=validObject.properties;validProperties instanceof Array||(validProperties=[validProperties]);const validPropertiesAndValues=(0,utilityFunctions_1.reduce)(object[table],toUsedProperties(validProperties));(0,utilityFunctions_1.isEmpty)(validPropertiesAndValues)||(validValues[table]=validPropertiesAndValues)}return(0,utilityFunctions_1.isEmpty)(validValues)?null:validValues}function toUsedProperties(propertiesArray){return function(usedProperties={},value,property,_object){return void 0===value||value<0||propertiesArray.includes(property)&&(usedProperties[property]=value),usedProperties}}exports.getValidValues=getValidValues,exports.toUsedProperties=toUsedProperties},81:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDB=exports.knex=exports.createSQL=void 0;const better_sqlite3_1=__importDefault(__webpack_require__(890)),mysql_1=__importDefault(__webpack_require__(744)),knex_1=__importDefault(__webpack_require__(514)),fs_1=__importDefault(__webpack_require__(147));function createDB({knexfileConfig,AppDataSource}){let result,sql,knex,typeorm;return result=getKnex(knexfileConfig),knex=result.knex,sql=result.sql,result=getTypeorm(AppDataSource),typeorm=result.typeorm,sql=result.sql,{knex,typeorm,sql}}function getKnex(knexfileConfig){if(!knexfileConfig)return{knex:void 0,sql:void 0};const knex=(0,knex_1.default)(knexfileConfig),sql=function(commands,parameters){return __awaiter(this,void 0,void 0,(function*(){const results=undefined;return(yield knex.raw(commands,parameters))[0]}))};return{knex,sql}}function getTypeorm(appDataSource){if(!appDataSource)return{typeorm:void 0,sql:void 0};const typeorm=appDataSource;typeorm.initialize();const sql=function(sqlCommands,parameters){return __awaiter(this,void 0,void 0,(function*(){const results=undefined;return yield typeorm.query(sqlCommands,parameters)}))};return{typeorm,sql}}exports.createDB=createDB;const knex=(0,knex_1.default)({client:"mysql",connection:{user:"root",password:"password",database:"sql_apprentice_2",multipleStatements:!0}});exports.knex=knex;class SQL extends better_sqlite3_1.default{constructor(cwd,filename){super(cwd+"/"+filename),this.cwd=cwd,this.filename=filename}runQuery(query,label=""){const results=this.prepare(query).all();return console.log(label,"\n",results,"\n"),results}runFile(filename,cwd=this.cwd){const SQLcommands=fs_1.default.readFileSync(cwd+"/"+filename);this.exec(SQLcommands.toString())}}function createSQL(cwd,filename){const mysql=mysql_1.default.createConnection({host:"localhost",user:"root",password:"password"});return console.log("SUCCESSFUL CONNECTION!"),mysql.raw=mysql_1.default.raw,mysql}exports.createSQL=createSQL,exports.default=SQL},820:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0});const httpCodes={success:{created:201,general:200,ok:200},error:{badRequest:400,conflict:409,forbiddenUser:403,general:400,unauthorized:401,unauthenticated:401,incorrectPassword:401,incorrectCredentials:401,serverError:500},redirect:{general:300}};exports.default=httpCodes},771:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.hash=void 0;const crypto_1=__importDefault(__webpack_require__(113));function hash(string,algorithm="sha256"){try{const hashCode=undefined;return crypto_1.default.createHash(algorithm).update(string).digest("hex")}catch(error){return}}exports.hash=hash},269:function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.toCloneDeep=exports.toClone=exports.toFormEntries=exports.toFields=exports.toArrayish=exports.timeout=exports.temporarilyShrink=exports.stringify=exports.serialize=exports.runCallback=exports.removeFileExtension=exports.removeElement=exports.reduceObject=exports.reduceArray=exports.reduce=exports.quoteValues=exports.pressEnter=exports.outValue=exports.outProperty=exports.outIndex=exports.noHandler=exports.matchValue=exports.matchAllProperties=exports.matchProperty=exports.matchIndex=exports.matchIsEqual=exports.mapProperties=exports.map=exports.isURL=exports.isObjectEmpty=exports.isArrayEmpty=exports.isEmpty=exports.isChar=exports.isHTMLfile=exports.isDOMobjectReady=exports.isUniqueValue=exports.hash=exports.getObjectProperties=exports.getUniqueValues=exports.getMultiArrayValue=exports.getFormEntries=exports.generateKey=exports.floorOf=exports.filterSort=exports.find=exports.convertToTextDocument=exports.convertToHtmlDocument=exports.combine=exports.copyValuesOf=void 0;const lodash_1=__webpack_require__(517),crypto_js_1=__importDefault(__webpack_require__(666));function copyValuesOf(source,copy){let property,value;for(property in source)try{value=source[property],copy[property]=value}catch(couldntCopyValue){console.log(`Couldn't copy ${property}:${value}`)}}function combine(value1,value2){if(typeof value1!=typeof value2)throw Error("Cannot combine different types");return"string"==typeof value1?`${value1} ${value2}`:value1 instanceof Array?[...value1,...value2]:"object"==typeof value1?Object.assign(Object.assign({},value1),value2):void 0}function removeElement(element,_index,_array){element.remove()}function convertToHtmlDocument(fileString){return __awaiter(this,void 0,void 0,(function*(){let htmlContent=yield convertToTextDocument(fileString),htmlDocument=(new DOMParser).parseFromString(htmlContent,"text/html");return isHTMLfile(fileString)?Promise.resolve(htmlDocument):Promise.reject(htmlDocument)}))}function convertToTextDocument(fileString){return __awaiter(this,void 0,void 0,(function*(){let fileContent=yield fetch(fileString),textContent;return yield fileContent.text()}))}function filterSort(array,isMatch){const match=undefined,notMatch=undefined;return reduce(array,toFilterSort,[[],[]]);function toFilterSort(filtered=[[],[]],value,_index,_array){const match=filtered[0],notMatch=filtered[1];return isMatch(value)?match.push(value):notMatch.push(value),filtered}}function find(collection,callback,startingIndex=0){if(0!==startingIndex)throw new Error("find() startingIndex not yet implemented");collection instanceof Array||(collection=[collection]),collection.find(callback)}function floorOf(number,decimalPlaces){const shifted=number*decimalPlaces*10,truncated=undefined,unshifted=undefined;return Math.trunc(shifted)/(10*decimalPlaces)}exports.copyValuesOf=copyValuesOf,exports.combine=combine,exports.removeElement=removeElement,exports.convertToHtmlDocument=convertToHtmlDocument,exports.convertToTextDocument=convertToTextDocument,exports.filterSort=filterSort,exports.find=find,exports.floorOf=floorOf;let numberOfKeysGenerated=0;function generateKey(){return(new Date).getTime()+"-"+numberOfKeysGenerated++}function getFormEntries(formElement){const fields=undefined;let entries;return reduce(formElement.querySelectorAll("[name]"),toFormEntries)}function getMultiArrayValue(indexArray,array){if(isEmpty(indexArray)){const value=undefined;return array}const index=indexArray.shift();return getMultiArrayValue(indexArray,array[index])}function getUniqueValues(array){const arrayWithUniqueValues=undefined;return array.filter(isUniqueValue)}function getObjectProperties(object){let property;const properties=[];for(property in object)properties.push(property);return properties}function hash(string){try{if(!string)return;const hashObject=crypto_js_1.default.SHA256(string),hashCode=undefined;return hashObject.toString(crypto_js_1.default.enc.Hex)}catch(error){return}}function isChar(string){return"string"==typeof string&&1===string.length}function isUniqueValue(value,index,array){return array.indexOf(value)===index}function isDOMobjectReady(DOMobject){if("loading"!==DOMobject.readyState)return DOMobject.removeEventListener("readystatechange",_listener),Promise.resolve(`${DOMobject} is ready`);function _listener(event){isDOMobjectReady(event.target)}DOMobject.addEventListener("readystatechange",_listener)}function isHTMLfile(filenameString){let htmlRegex;return/\.html$/.test(filenameString)}function isEmpty(object){return object instanceof Array?isArrayEmpty(object):object instanceof Object?isObjectEmpty(object):null==object||""===object}function isArrayEmpty(array){if(!array)return array;const numberOfValues=undefined;return 0===array.length}function isObjectEmpty(object){const numberOfValues=undefined;return 0===Object.keys(object).length}function isURL(urlString){let urlRegex;return/^http(s):\/\//i.test(urlString)}function map(collection,callback){return collection instanceof Array||(collection=[collection]),collection.map(callback)}function mapProperties(object,callback){if(!object)return[];const properties=Object.getOwnPropertyNames(object);if(!properties)return[];const results=[];return properties.forEach((property=>{const result=callback(object[property],property,object);results.push(result)})),results}function matchIsEqual(value){return function(value2,_index,_array){return(0,lodash_1.isEqual)(value,value2)}}function matchIndex(indexToMatch){return function(_value,index,_array){return index===indexToMatch}}function matchProperty(property,valueToMatch){return"string"==typeof property&&(property=[property]),function(object,_index,_array){let value=object;try{for(let stringIndex of property)value=value[stringIndex];return value===valueToMatch}catch(invalidProperty){return!1}}}function matchAllProperties(propertiesAndValues){return function(object,_index,_array){let isMatching=!0;for(let property in propertiesAndValues){const value=propertiesAndValues[property];if(isMatching=isMatching&&object[property]===value,!isMatching)return!1}return!0}}function matchValue(valueToMatch){return function(value,_index,_array){return value===valueToMatch}}function noHandler(){}function outIndex(indexToRemove){return function(_value,index,_array){return index!==indexToRemove}}function outProperty(property,valueToMatch){return"string"==typeof property&&(property=[property]),function(object,_index,_array){let value=object;for(let stringIndex of property)value=value[stringIndex];return value!==valueToMatch}}function outValue(valueToRemove){return function(value,_index,_array){return value!==valueToRemove}}function pressEnter(){return new Promise(_pressEnter);function _pressEnter(resolve,_reject){process.stdin.resume(),process.stdin.once("data",(()=>(process.stdin.pause(),resolve())))}}function quoteValues(array){if(!array)return array;const quotedArray=undefined;return array.map((value=>`"${value}"`))}function serialize(object){const serialized={};for(let property in object){const value=object[property];serialized[property]=value}return serialized}function stringify(object){const replacer=void 0,spacer=" ",string=undefined;return JSON.stringify(object,undefined," ")}function temporarilyShrink(htmlElement){let container=htmlElement.parentElement,{offsetHeight:containerHeight,offsetWidth:containerWidth}=container||{};const originalContainerSize=forceStyleSize(container,containerHeight,containerWidth),currentHeight=htmlElement.offsetHeight,currentWidth=htmlElement.offsetWidth,shrinkPercent=.05,tempHeight=undefined,tempWidth=undefined,originalElementSize=forceStyleSize(htmlElement,currentHeight-.05*currentHeight,currentWidth-.05*currentWidth),delay=100;function restoreSizes(){const originalHeight=originalElementSize.offsetHeight,originalWidth=originalElementSize.offsetWidth;forceStyleSize(htmlElement,originalHeight,originalWidth),restoreStyleSize(htmlElement,originalElementSize),restoreStyleSize(container,originalContainerSize)}setTimeout(restoreSizes,100)}function reduce(collection,callback,initialValue){return collection?collection instanceof Array?reduceArray(collection,callback,initialValue):reduceObject(collection,callback,initialValue):initialValue}function reduceArray(array,callback,initialValue){if(!(array instanceof Array))throw new Error("An array was not passed to reduceArray()");let reducedValue=initialValue;return array.forEach((function(currentValue,index,arrayCopy){reducedValue=callback(reducedValue,currentValue,index,arrayCopy)})),0===array.length&&(reducedValue=callback(reducedValue)),reducedValue}function reduceObject(object,callback,initialValue){if(object instanceof Array||"string"==typeof object||"number"==typeof object)throw new Error("An object was not passed to reduceObject()");let reducedValue=initialValue;for(let property in object){const value=undefined;reducedValue=callback(reducedValue,object[property],property,object)}return isEmpty(object)&&(reducedValue=callback(reducedValue)),reducedValue}function removeFileExtension(filename){const splitFilename=filename.split(".");splitFilename.length>2&&splitFilename.pop();const extensionRemoved=undefined;return splitFilename.join(".")}function restoreStyleSize(htmlElement,originalSizeObject){const original=originalSizeObject;htmlElement.style.height=original.style.height,htmlElement.style.width=original.style.width}function runCallback(callback,_index,_array){callback()}function forceStyleSize(htmlElement,height,width){const originalSize={style:{height:htmlElement.style.height,width:htmlElement.style.width},offsetHeight:htmlElement.offsetHeight,offsetWidth:htmlElement.offsetWidth};return htmlElement.style.height=`${height}px`,htmlElement.style.width=`${width}px`,originalSize}function timeout(milliseconds){return new Promise((function(resolvePromise){setTimeout((()=>resolvePromise("Timeout complete")),milliseconds)}))}function toArrayish(arrayish={},value,index,_array){return arrayish[index]=value,arrayish}function toFields(fieldList,object,index,_array){fieldList instanceof Array||(fieldList=[]);const fields=Object.keys(object),newFields=(0,lodash_1.difference)(fields,fieldList);return fieldList=fieldList.concat(newFields)}function toFormEntries(entries={},element,index,_array){const name=element.name,value=element.value;return name&&(entries[name]=value),entries}function toClone(value,_index,_array){return value}function toCloneDeep(value,_index,_array){return(0,lodash_1.cloneDeep)(value)}exports.generateKey=generateKey,exports.getFormEntries=getFormEntries,exports.getMultiArrayValue=getMultiArrayValue,exports.getUniqueValues=getUniqueValues,exports.getObjectProperties=getObjectProperties,exports.hash=hash,exports.isChar=isChar,exports.isUniqueValue=isUniqueValue,exports.isDOMobjectReady=isDOMobjectReady,exports.isHTMLfile=isHTMLfile,exports.isEmpty=isEmpty,exports.isArrayEmpty=isArrayEmpty,exports.isObjectEmpty=isObjectEmpty,exports.isURL=isURL,exports.map=map,exports.mapProperties=mapProperties,exports.matchIsEqual=matchIsEqual,exports.matchIndex=matchIndex,exports.matchProperty=matchProperty,exports.matchAllProperties=matchAllProperties,exports.matchValue=matchValue,exports.noHandler=noHandler,exports.outIndex=outIndex,exports.outProperty=outProperty,exports.outValue=outValue,exports.pressEnter=pressEnter,exports.quoteValues=quoteValues,exports.serialize=serialize,exports.stringify=stringify,exports.temporarilyShrink=temporarilyShrink,exports.reduce=reduce,exports.reduceArray=reduceArray,exports.reduceObject=reduceObject,exports.removeFileExtension=removeFileExtension,exports.runCallback=runCallback,exports.timeout=timeout,exports.toArrayish=toArrayish,exports.toFields=toFields,exports.toFormEntries=toFormEntries,exports.toClone=toClone,exports.toCloneDeep=toCloneDeep},139:module=>{module.exports=require("@sendgrid/mail")},890:module=>{module.exports=require("better-sqlite3")},582:module=>{module.exports=require("cors")},666:module=>{module.exports=require("crypto-js")},142:module=>{module.exports=require("dotenv")},860:module=>{module.exports=require("express")},514:module=>{module.exports=require("knex")},517:module=>{module.exports=require("lodash")},744:module=>{module.exports=require("mysql")},236:module=>{module.exports=require("reflect-metadata")},250:module=>{module.exports=require("typeorm")},113:module=>{module.exports=require("crypto")},147:module=>{module.exports=require("fs")}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.exports}var __webpack_exports__=__webpack_require__(632)})();